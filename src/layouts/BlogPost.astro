---
import '../styles/main.scss';
import BaseHead from '@components/BaseHead.astro';
import { BuildInfo } from '@components/BuildInfo/BuildInfo';
import { Navbar } from '@components/Navbar/Navbar';
import { changeLanguage } from 'i18next';
import { getCanonicalURL } from 'utils/routing';

const { content } = Astro.props;

const { title, description } = content;
const canonicalURL = getCanonicalURL(Astro);

const relativePageUrl =
  canonicalURL.pathname.replace(/([^/]+)\/$/g, '$1') +
  canonicalURL.search +
  canonicalURL.hash;
const lang = content.lang || 'en';

changeLanguage(lang);
---

<html lang={lang} class="rmjs-yellow-black-theme">
  <head>
    <BaseHead title={title} description={description} />
    <slot name="head" />
  </head>

  <main class="main">
    <Navbar
      client:load
      lang={lang}
      urlMap={null}
      relativePageUrl={relativePageUrl}
    />
    <slot />
  </main>
  <slot name="after" />
  <BuildInfo />
</html>
